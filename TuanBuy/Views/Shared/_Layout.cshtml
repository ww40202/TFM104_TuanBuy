@using Microsoft.AspNetCore.Mvc.Infrastructure
@using System.Security.Claims

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Ashion Template">
    <meta name="keywords" content="Ashion, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TuanBuy</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Js Plugins -->
    <script src="~/js/jquery-3.3.1.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/jquery.magnific-popup.min.js"></script>
    <script src="~/js/jquery-ui.min.js"></script>
    <script src="~/js/mixitup.min.js"></script>
    <script src="~/js/jquery.countdown.min.js"></script>
    <script src="~/js/jquery.slicknav.js"></script>
    <script src="~/js/owl.carousel.min.js"></script>
    <script src="~/js/jquery.nicescroll.min.js"></script>
    <script src="~/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <!-- JS dropdown -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <!--套用vue -->
    <script src="~/js/vue.min.js"></script>
    
    @*<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js">*@
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cookie&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800;900&display=swap"
          rel="stylesheet">
    <!-- Css Styles -->
    <link rel="stylesheet" href="~/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="~/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="~/css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="~/css/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="~/css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="~/css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="~/css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="~/css/style.css" type="text/css">
    <!-- 本機 -->
    <link rel="stylesheet" href="~/css/mystyle.css">

</head>

<body>
<!-- Page Preloder -->
<div id="preloder">
    <div class="loader"></div>
</div>

<!-- Offcanvas Menu Begin -->
<div class="offcanvas-menu-overlay"></div>
<div class="offcanvas-menu-wrapper">
    <div class="offcanvas__close">+</div>
    <div class="offcanvas__logo">
        <a href="./index.html"><img src="~/img/logo.png" alt=""></a>
    </div>
    <div id="mobile-menu-wrap"></div>
    <div class="offcanvas__auth">
        <a href=@Url.Action("Register","Home")>註冊</a>
        <a href=@Url.Action("Login","Home")>登入</a>
    </div>
</div>
<!-- Offcanvas Menu End -->
<!-- Header Section Begin -->
<header class="header" id="layout">
    <div class="container">
        <div class="row">
            <div class="col-lg-2 texthead1">
                <a href=@Url.Action("Index","Home")><img src="/img/Log.jpg" alt=""></a>
            </div>
            <div class="col-lg-7 texthead2">
                <p class="display headsize1">|</p>
                <a class="display headsize" href=@Url.Action("Index","Product")>開團</a>
            </div>
            @{
                System.Diagnostics.Debug.Assert(User.Identity != null, "User.Identity != null");
                if (User.Identity.IsAuthenticated)
                {
                    @if(User.IsInRole("")){
                        Console.WriteLine("管理員");
                    }
                    <div class="col-lg-3 texthead3">
                        <a class="display headsize3" href="#"><img src="/img/Ring.jpg" alt="Ring"></a>
                        <div class="dropdown display">
                            <button class="btn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-expanded="false">
                                <p class="headsize display" href="#">
                                    <img v-bind:src="picPath.picPath"alt="Avatar" width="40" height="40">
                                </p>
                                <p class="headnamesize display">{{user}}</p>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <div><a href=@Url.Action("Index","MemberCenter")>會員中心</a></div>
                                <div><a href=@Url.Action("ChatRoom","Member")>聊天室</a></div>
                                <div><a href=@Url.Action("ReadyProduct","Product")>已開團</a></div>
                                <div><a href=@Url.Action("WaitingProduct","Product")>等待開團</a></div>
                                <div><a href="#" v-on:click="logout">登出</a></div>
                            </div>
                        </div>
                    </div>
                }
                else
                {
                    <div class="col-lg-3 texthead3" >
                        <a class="display headsize3" href=@Url.Action("Register","Home")>註冊</a>
                        <a class="display headsize" href=@Url.Action("Login","Home")>登入</a>
                    </div>
                }
            }

        </div>
    </div>
</header>
<!-- Header Section End -->
@RenderBody();

<!-- Footer Section Begin -->
<footer class="ftborder">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 textft1">
                <a href="#"><img src="/img/Log.jpg" alt="logo"></a>
            </div>
            <div class="col-lg-6 textft2">
                <a class="display headsize3" href="#">關於</a>
                <a class="display headsize3" href="#">聯絡我們</a>
            </div>
            <div class="col-lg-3 footer__social textft3">
                <a href="#"><i class="fa fa-facebook"></i></a>
                <a href="#"><i class="fa fa-twitter"></i></a>
                <a href="#"><i class="fa fa-instagram"></i></a>
            </div>
        </div>
    </div>
</footer>
<!-- Footer Section End -->



</body>
</html>

<script>
    var layout = new Vue({
        el: '#layout',
        data: {
            user: "",
            picPath:""
        },
        mounted:function () {
            let self = this;
            axios.get("/api/LoginAndRegister/").then((resp) => {
                this.user = resp.data;
            });
            axios.get("/api/MemberCenter/").then((resp) => { this.picPath = resp.data });
        },
        methods: {
            logout:function() {
                axios.delete("/api/LoginAndRegister").then(()=>
                {
                    window.location.href = "/Home/Index";
                });
            }
        }

    })

</script>